coord_polar(start = 0) +
geom_text(data=label_data, aes(x=id, y=cagr2035+10, label=district, hjust=hjust), color="black", fontface="bold",alpha=0.6, size=2.5, angle= label_data$angle, inherit.aes = FALSE )
p+labs(title = "Projected CAGR of populuation over 65, 2017-2035")
p
p = ggplot(data, aes(x=as.factor(id), y=cagr2035)) + geom_bar(stat="identity", fill=as.factor(data$county_level)) +
theme_minimal() +
theme(axis.text = element_blank(), axis.title = element_blank(), panel.grid = element_blank(), plot.margin = unit(rep(1,4), "cm")) +
coord_polar(start = 0) +
geom_text(data=label_data, aes(x=id, y=cagr2035+10, label=district, hjust=hjust), color="black", fontface="bold",alpha=0.6, size=2.5, angle= label_data$angle, inherit.aes = FALSE )
p+labs(title = "Projected CAGR of populuation over 65, 2017-2035")
p
length(data$county_level)
length(as.factor(data$county_level))
data$county_level
data$county_level
data=data.frame(
id<-seq(1,75),
district<-d$district,
county_level<-d$county_level,
cagr2035<-d$cagr2035/max(d$cagr2035)*100)
colnames(data)<-c("id","district","cagr2035")
data$county_level
str(data)
d$county_level
View(data)
data=data.frame(
id<-seq(1,75),
district<-d$district,
county_level<-d$county_level,
cagr2035<-d$cagr2035/max(d$cagr2035)*100)
colnames(data)<-c("id","district","county_level","cagr2035")
label_data=data
label_data$district<-as.factor(paste(as.character(d$district)," (",round(d$cagr2035*100,1),"%)",sep=""))
number_of_bar=nrow(label_data)
angle= 90 - 360 * (label_data$id-0.5) /number_of_bar
label_data$hjust<-ifelse( angle < -90, 1, 0)
label_data$angle<-ifelse(angle < -90, angle+180, angle)
p = ggplot(data, aes(x=as.factor(id), y=cagr2035)) + geom_bar(stat="identity", fill=county_level) + ylim(-100,200) +
theme_minimal() +
theme(axis.text = element_blank(), axis.title = element_blank(), panel.grid = element_blank(), plot.margin = unit(rep(1,4), "cm")) +
coord_polar(start = 0) +
geom_text(data=label_data, aes(x=id, y=cagr2035+10, label=district, hjust=hjust), color="black", fontface="bold",alpha=0.6, size=2.5, angle= label_data$angle, inherit.aes = FALSE )
p+labs(title = "Projected CAGR of populuation over 65, 2017-2035")
p
p = ggplot(data, aes(x=as.factor(id), y=cagr2035)) + geom_bar(stat="identity", fill=data$county_level) + ylim(-100,200) +
theme_minimal() +
theme(axis.text = element_blank(), axis.title = element_blank(), panel.grid = element_blank(), plot.margin = unit(rep(1,4), "cm")) +
coord_polar(start = 0) +
geom_text(data=label_data, aes(x=id, y=cagr2035+10, label=district, hjust=hjust), color="black", fontface="bold",alpha=0.6, size=2.5, angle= label_data$angle, inherit.aes = FALSE )
p+labs(title = "Projected CAGR of populuation over 65, 2017-2035")
p
p = ggplot(data, aes(x=as.factor(id), y=cagr2035)) + geom_bar(stat="identity") + ylim(-100,200) +
theme_minimal() +
theme(axis.text = element_blank(), axis.title = element_blank(), panel.grid = element_blank(), plot.margin = unit(rep(1,4), "cm")) +
coord_polar(start = 0) +
geom_text(data=label_data, aes(x=id, y=cagr2035+10, label=district, hjust=hjust), color="black", fontface="bold",alpha=0.6, size=2.5, angle= label_data$angle, inherit.aes = FALSE )
p+labs(title = "Projected CAGR of populuation over 65, 2017-2035")
p
p = ggplot(data, aes(x=as.factor(id), y=cagr2035)) + geom_bar(stat="identity", fill=as.factor(data$county_level)) + ylim(-100,200) +
theme_minimal() +
theme(axis.text = element_blank(), axis.title = element_blank(), panel.grid = element_blank(), plot.margin = unit(rep(1,4), "cm")) +
coord_polar(start = 0) +
geom_text(data=label_data, aes(x=id, y=cagr2035+10, label=district, hjust=hjust), color="black", fontface="bold",alpha=0.6, size=2.5, angle= label_data$angle, inherit.aes = FALSE )
p+labs(title = "Projected CAGR of populuation over 65, 2017-2035")
p
?as.factor
b<-factor(d$country)
b<-factor(d$county_level,levels=c(1,0), labels = c("County or region","District"))
head(b)
b<-factor(as.character(d$county_level),levels=c(1,0), labels = c("County or region","District"))
b
b<-factor(as.numeric(d$county_level),levels=c(1,0), labels = c("County or region","District"))
b
data=data.frame(
id<-seq(1,75),
district<-d$district,
county_level<-actor(as.numeric(d$county_level),levels=c(1,0), labels = c("County or region","District")),
cagr2035<-d$cagr2035/max(d$cagr2035)*100)
colnames(data)<-c("id","district","county_level","cagr2035")
data=data.frame(
id<-seq(1,75),
district<-d$district,
county_level<-factor(as.numeric(d$county_level),levels=c(1,0), labels = c("County or region","District")),
cagr2035<-d$cagr2035/max(d$cagr2035)*100)
colnames(data)<-c("id","district","county_level","cagr2035")
#Create labels (and append growth rates)
label_data=data
label_data$district<-as.factor(paste(as.character(d$district)," (",round(d$cagr2035*100,1),"%)",sep=""))
number_of_bar=nrow(label_data)
angle= 90 - 360 * (label_data$id-0.5) /number_of_bar
label_data$hjust<-ifelse( angle < -90, 1, 0)
label_data$angle<-ifelse(angle < -90, angle+180, angle)
p = ggplot(data, aes(x=as.factor(id), y=cagr2035)) + geom_bar(stat="identity", fill=county_level) + ylim(-100,200) +
theme_minimal() +
theme(axis.text = element_blank(), axis.title = element_blank(), panel.grid = element_blank(), plot.margin = unit(rep(1,4), "cm")) +
coord_polar(start = 0) +
geom_text(data=label_data, aes(x=id, y=cagr2035+10, label=district, hjust=hjust), color="black", fontface="bold",alpha=0.6, size=2.5, angle= label_data$angle, inherit.aes = FALSE )
p+labs(title = "Projected CAGR of populuation over 65, 2017-2035")
p
p = ggplot(data, aes(x=as.factor(id), y=cagr2035)) + geom_bar(stat="identity", fill="county_level") + ylim(-100,200) +
theme_minimal() +
theme(axis.text = element_blank(), axis.title = element_blank(), panel.grid = element_blank(), plot.margin = unit(rep(1,4), "cm")) +
coord_polar(start = 0) +
geom_text(data=label_data, aes(x=id, y=cagr2035+10, label=district, hjust=hjust), color="black", fontface="bold",alpha=0.6, size=2.5, angle= label_data$angle, inherit.aes = FALSE )
p+labs(title = "Projected CAGR of populuation over 65, 2017-2035")
p
8451-7674
library(reshape2)
library(data.table)
library(dplyr)
library(ggplot2)
install.packages("tidyverse", repos = "http://cran.us.r-project.org")
library(tidyverse)
#get names all downloaded files
filenames<-list.files(path="~/Google Drive/Datasets/POPPI downloads 180115", full.names = TRUE)
#read all downloaded files into two dataframes
popnext5<-data.frame()
popto2035<-data.frame()
for (i in 1:length(filenames)) {
a<-read.csv(filenames[i],stringsAsFactors = FALSE, skip = 3)
a<-head(a, -4) #remove last four rows
if(names(a[3])=="X2018") {
popnext5<-rbind(popnext5,a)
}
else {
popto2035<-rbind(popto2035,a)
}
}
colnames(popnext5)<-c("description","y2017","y2018","y2019","y2020","y2021")
colnames(popto2035)<-c("description","y2017","y2020","y2025","y2030","y2035")
#remove duplicated rows and merge the two datasets
popnext5<-popnext5[!duplicated(popnext5),]
popto2035<-popto2035[!duplicated(popto2035),]
pop<-merge(popnext5,popto2035,by = c("description","y2017","y2020"))
rm(popnext5); rm(popto2035)
#parse the description into separate fields
a<-strsplit(pop$description,":")
b<-matrix(data = unlist(a),ncol = 2, byrow = TRUE); rm(a)
b<-as.data.frame(b)
#make data table with desired fields
pop<-data.table(pop,district = b$V1,age=b$V2); rm(b)
pop<-pop[,y2017:age]
#remove commas in numeric fields
pop$y2017<-as.numeric(gsub(",", "", pop$y2017))
pop$y2018<-as.numeric(gsub(",", "", pop$y2018))
pop$y2019<-as.numeric(gsub(",", "", pop$y2019))
pop$y2020<-as.numeric(gsub(",", "", pop$y2020))
pop$y2021<-as.numeric(gsub(",", "", pop$y2021))
pop$y2025<-as.numeric(gsub(",", "", pop$y2025))
pop$y2030<-as.numeric(gsub(",", "", pop$y2030))
pop$y2035<-as.numeric(gsub(",", "", pop$y2035))
#calculate CAGR - note - hardcoding the year interval
pop$cagr2035<-(pop$y2035/pop$y2017)^(1/18)-1
pop$cagr2025<-(pop$y2025/pop$y2017)^(1/8)-1
#identify the county level categories
a<-strsplit(filenames,"15-01-18_")
b<-matrix(data = unlist(a),ncol = 2, byrow = TRUE)
c<-strsplit(b[,2],"_and")
d<-matrix(data = unlist(c),ncol = 2, byrow = TRUE)
county_names<-unique(d[,1])
county_names<-sub("_"," ", county_names)
pop<-pop[,county_level:=pop$district %in% county_names]
#identify the total categories
pop<-pop[,categ_total:=grepl("Total",pop$age)]
a<-pop[ categ_total == 1 & district=="South East"]
a<-a[,y2017:y2035]
names(a)<-(gsub("y", "", names(a))) #remove y from col names to make plot easier
b<-data.frame(year = as.character(names(a)), pop = round((as.numeric(a[1,]))/1000000,2))
p<-ggplot(data=b, aes(x=year, y=pop)) +
geom_bar(stat="identity", fill=alpha("skyblue", 0.7), width = .7) +
labs(title="Growth in number of people over 65 in the South East", x="Year", y = "Population (millions)") +
geom_text(aes(label=pop), vjust=1.6, size=3.5) +
theme_minimal() +
theme(panel.grid = element_blank())
p
p
a<-pop[ categ_total == 1 & district=="South East"]
a<-a[,y2017:y2035]
names(a)<-(gsub("y", "", names(a))) #remove y from col names to make plot easier
b<-data.frame(year = as.character(names(a)), pop = round((as.numeric(a[1,]))/1000000,3))
p<-ggplot(data=b, aes(x=year, y=pop)) +
geom_bar(stat="identity", fill=alpha("skyblue", 0.7), width = .7) +
labs(title="Growth in number of people over 65 in the South East", x="Year", y = "Population (millions)") +
geom_text(aes(label=pop), vjust=1.6, size=3.5) +
theme_minimal() +
theme(panel.grid = element_blank())
p
names(pop)
poplong<-melt(pop, id.vars = c("district","age","county_level, categ_total"), measure.vars = c("y2017","y2018","y2019","y2020","y2021","y2025","y2030","y2035"))
poplong<-melt(pop, id.vars = c("district","age","county_level", "categ_total"), measure.vars = c("y2017","y2018","y2019","y2020","y2021","y2025","y2030","y2035"))
head(poplong)
head(poplong,10)
colnames(poplong)<-c("district","age","county_level","categ_total", "year","pop")
poplong$year<-as.numeric(gsub("y", "", poplong$year)) #remove y from col names to make plot easier
head(poplong,10)
poplong_notot<-poplong[ county_level!=1 & categ_total!=1]
head(poplong_notot,10)
poplong_notot<-poplong_notot[ -county_level -categ_total]
head(poplong_notot,10)
poplong_notot<-poplong[ county_level!=1 & categ_total!=1]
poplong_notot<-poplong_notot[, -county_level -categ_total]
head(poplong_notot,10)
poplong_notot<-poplong[ county_level!=1 & categ_total!=1]
poplong_notot<-poplong_notot[, c("county_level","categ_total"):=NULL]
head(poplong_notot,10)
b<-data.frame(poplong_notot)
head(b)
p<-ggplot(data=b, aes(x=year, y=pop)) +
geom_bar(stat="identity", fill=age, width = .7) +
labs(title="Growth in number of people over 65 in the South East", x="Year", y = "Population (millions)") +
geom_text(aes(label=pop), vjust=1.6, size=3.5) +
theme_minimal() +
theme(panel.grid = element_blank())
names(b)
p<-ggplot(data=b, aes(x=year, y=pop)) +
geom_bar(stat="identity", fill=b$age, width = .7) +
labs(title="Growth in number of people over 65 in the South East", x="Year", y = "Population (millions)") +
geom_text(aes(label=pop), vjust=1.6, size=3.5) +
theme_minimal() +
theme(panel.grid = element_blank())
p
p<-ggplot(data=b, aes(x=year, y=pop, fill=age)) +
geom_bar(stat="identity",  width = .7) +
labs(title="Growth in number of people over 65 in the South East", x="Year", y = "Population (millions)") +
geom_text(aes(label=pop), vjust=1.6, size=3.5) +
theme_minimal() +
theme(panel.grid = element_blank())
p
p
p
str(b)
p<-ggplot(data=b, aes(x=year, y=pop, fill=age)) +
geom_bar(stat="identity",  width = .7) +
labs(title="Growth in number of people over 65 in the South East", x="Year", y = "Population (millions)") +
theme_minimal() +
theme(panel.grid = element_blank())
p
b<-data.frame(poplong_notot)
b$year<-b$year/1000
p<-ggplot(data=b, aes(x=year, y=pop, fill=age)) +
geom_bar(stat="identity",  width = .7) +
labs(title="Growth in number of people over 65 in the South East", x="Year", y = "Population (millions)") +
theme_minimal() +
theme(panel.grid = element_blank())
p
b<-data.frame(poplong_notot)
b$pop<-b$pop/1000
p<-ggplot(data=b, aes(x=year, y=pop, fill=age)) +
geom_bar(stat="identity",  width = .7) +
labs(title="Growth in number of people over 65 in the South East", x="Year", y = "Population (millions)") +
theme_minimal() +
theme(panel.grid = element_blank())
p
p<-ggplot(data=b, aes(x=year, y=pop, fill=age)) +
geom_bar(stat="identity",  width = .7) +
labs(title="Growth in number of people over 65 in the South East", x="Year", y = "Population (thousands)") +
theme_minimal()
p
a<-pop[ categ_total == 1 & district=="South East"]
a<-a[,y2017:y2035]
names(a)<-(gsub("y", "", names(a))) #remove y from col names to make plot easier
b<-data.frame(year = as.character(names(a)), pop = round((as.numeric(a[1,]))/1000000,2))
str(b)
b<-data.frame(year = as.numeric(as.character(names(a))), pop = round((as.numeric(a[1,]))/1000000,2))
str(b)
b<-data.frame(year = as.numeric((names(a)), pop = round((as.numeric(a[1,]))/1000000,2))
)
str(b)
b<-data.frame(year = as.numeric((names(a))), pop = round((as.numeric(a[1,]))/1000000,2))
str(b)
p<-ggplot(data=b, aes(x=year, y=pop)) +
geom_bar(stat="identity", fill=alpha("skyblue", 0.7), width = .7) +
labs(title="Growth in number of people over 65 in the South East", x="Year", y = "Population (millions)") +
geom_text(aes(label=pop), vjust=1.6, size=3.5) +
theme_minimal() +
theme(panel.grid = element_blank())
p
p<-ggplot(data=b, aes(x=year, y=pop)) +
geom_bar(stat="identity", fill=alpha("skyblue", 0.7), width = .7) +
labs(title="Growth in number of people over 65 in the South East", x="Year", y = "Population (millions)") +
geom_text(aes(label=pop), vjust=1.6, size=3.5) +
theme_minimal()
p
p<-ggplot(data=b, aes(x=year, y=pop)) +
geom_bar(stat="identity", fill=alpha("skyblue", 0.7), width = .7) +
labs(title="Growth in number of people over 65 in the South East", x="Year", y = "Population (millions)") +
geom_text(aes(label=pop), vjust=1.6, size=3) +
theme_minimal()
p
rm(list = ls()
)
#get names all downloaded files
filenames<-list.files(path="~/Google Drive/Datasets/POPPI downloads 180115", full.names = TRUE)
#read all downloaded files into two dataframes
popnext5<-data.frame()
popto2035<-data.frame()
for (i in 1:length(filenames)) {
a<-read.csv(filenames[i],stringsAsFactors = FALSE, skip = 3)
a<-head(a, -4) #remove last four rows
if(names(a[3])=="X2018") {
popnext5<-rbind(popnext5,a)
}
else {
popto2035<-rbind(popto2035,a)
}
}
colnames(popnext5)<-c("description","y2017","y2018","y2019","y2020","y2021")
colnames(popto2035)<-c("description","y2017","y2020","y2025","y2030","y2035")
#remove duplicated rows and merge the two datasets
popnext5<-popnext5[!duplicated(popnext5),]
popto2035<-popto2035[!duplicated(popto2035),]
pop<-merge(popnext5,popto2035,by = c("description","y2017","y2020"))
rm(popnext5); rm(popto2035)
#parse the description into separate fields
a<-strsplit(pop$description,":")
b<-matrix(data = unlist(a),ncol = 2, byrow = TRUE); rm(a)
b<-as.data.frame(b)
#make data table with desired fields
pop<-data.table(pop,district = b$V1,age=b$V2); rm(b)
pop<-pop[,y2017:age]
#remove commas in numeric fields
pop$y2017<-as.numeric(gsub(",", "", pop$y2017))
pop$y2018<-as.numeric(gsub(",", "", pop$y2018))
pop$y2019<-as.numeric(gsub(",", "", pop$y2019))
pop$y2020<-as.numeric(gsub(",", "", pop$y2020))
pop$y2021<-as.numeric(gsub(",", "", pop$y2021))
pop$y2025<-as.numeric(gsub(",", "", pop$y2025))
pop$y2030<-as.numeric(gsub(",", "", pop$y2030))
pop$y2035<-as.numeric(gsub(",", "", pop$y2035))
#calculate CAGR - note - hardcoding the year interval
pop$cagr2035<-(pop$y2035/pop$y2017)^(1/18)-1
pop$cagr2025<-(pop$y2025/pop$y2017)^(1/8)-1
#identify the county level categories
a<-strsplit(filenames,"15-01-18_")
b<-matrix(data = unlist(a),ncol = 2, byrow = TRUE)
c<-strsplit(b[,2],"_and")
d<-matrix(data = unlist(c),ncol = 2, byrow = TRUE)
county_names<-unique(d[,1])
county_names<-sub("_"," ", county_names)
pop<-pop[,county_level:=pop$district %in% county_names]
#identify the total categories
pop<-pop[,categ_total:=grepl("Total",pop$age)]
```
names(pop)
a<-pop[ categ_total == 1 & district=="South East"]
a<-a[,y2017:y2035]
names(a)<-(gsub("y", "", names(a))) #remove y from col names to make plot easier
b<-data.frame(year = as.numeric((names(a))), pop = round((as.numeric(a[1,]))/1000000,2))
p<-ggplot(data=b, aes(x=year, y=pop)) +
geom_bar(stat="identity", fill=alpha("skyblue", 0.7), width = .7) +
labs(title="Growth in number of people over 65 in the South East", x="Year", y = "Population (millions)") +
geom_text(aes(label=pop), vjust=1.6, size=3) +
theme_minimal()
p
#make long thin dataset - note this includes county level and a summary for the South East
poplong<-melt(pop, id.vars = c("district","age","county_level", "categ_total"), measure.vars = c("y2017","y2018","y2019","y2020","y2021","y2025","y2030","y2035"))
colnames(poplong)<-c("district","age","county_level","categ_total", "year","pop")
poplong$year<-as.numeric(gsub("y", "", poplong$year)) #remove y from col names to make plot easier
#make another version without totals for each age category or South East
poplong_notot<-poplong[ county_level!=1 & categ_total!=1]
poplong_notot<-poplong_notot[, c("county_level","categ_total"):=NULL] #remove columns that are no longer needed
#make plot of population by age
b<-data.frame(poplong_notot)
b$pop<-b$pop/1000
p<-ggplot(data=b, aes(x=year, y=pop, fill=age)) +
geom_bar(stat="identity",  width = .7) +
labs(title="Growth in number of people over 65 in the South East, by age", x="Year", y = "Population (thousands)") +
theme_minimal()
p
d<-pop[ district=="South East"]
d<-d[,y2017:y2035]
d
names(d)<-(gsub("y", "", names(d))) #remove y from col names to make plot easier
d<-pop[ district=="South East"]
names(d)
d<-d[,age:cagr2025]
d
p<-ggplot(data=d, aes(x=age, y=cagr2025)) +
geom_bar(stat="identity",  width = .7) +
labs(title="Growth in number of people over 65 in the South East, by age", x="Year", y = "Population (thousands)") +
theme_minimal()
p
p + coord_flip()
p<-ggplot(data=d, aes(x=age, y=cagr2025, fill = age)) +
geom_bar(stat="identity",  width = .5) +
labs(title="Growth in number of people over 65 in the Soutp +h East, by age", x="Year", y = "Population (thousands)") +
theme_minimal()
p
d$cagr2025<-d$cagr2025*100
p<-ggplot(data=d, aes(x=age, y=cagr2025, fill = age)) +
geom_bar(stat="identity",  width = .5) +
labs(title="Compound growth rate between 2017 and 2025 (%)", x="Year", y = "Population (thousands)") +
theme_minimal()
p + coord_flip()
p<-ggplot(data=d, aes(x=age, y=cagr2025, fill = age)) +
geom_bar(stat="identity",  width = .5) +
labs(title="Compound growth rate between 2017 and 2025 (%)", x="Year", y = "CAGR (%)") +
theme_minimal() + theme(legend.position = "none")
p + coord_flip()
p<-ggplot(data=d, aes(x=age, y=cagr2025, fill = age)) +
geom_bar(stat="identity",  width = .5) +
labs(title="Compound growth rate between 2017 and 2025 (%)", y = "CAGR (%)") +
theme_minimal() + theme(legend.position = "none") +  +
geom_text(aes(label=cagr2025), vjust=1.6, size=3)
p + coord_flip()
p<-ggplot(data=d, aes(x=age, y=cagr2025, fill = age)) +
geom_bar(stat="identity",  width = .5) +
labs(title="Compound growth rate between 2017 and 2025 (%)", y = "CAGR (%)") +
theme_minimal() + theme(legend.position = "none") +  +
geom_text(aes(label=age), vjust=1.6, size=3)
p + coord_flip()
b$age
d&age
d$age
d$cagr2025
label_text<-paste(round(d$cagr2025*100,2),"%")
label_text
label_text<-paste(round(d$cagr2025*100,0),"%")
label_text<-paste(round(d$cagr2025*100,0),"%", sep = "")
label_text
label_text<-paste(round(d$cagr2025,0),"%", sep = "")
label_text
label_text<-paste(round(d$cagr2025,2),"%", sep = "")
label_text
p<-ggplot(data=d, aes(x=age, y=cagr2025, fill = age)) +
geom_bar(stat="identity",  width = .5) +
labs(title="Compound growth rate between 2017 and 2025 (%)", y = "CAGR (%)") +
theme_minimal() + theme(legend.position = "none") +  +
geom_text(aes(label=label_text), vjust=1.6, size=3)
p + coord_flip()
p<-ggplot(data=d, aes(x=age, y=cagr2025, fill = age)) +
geom_bar(stat="identity",  width = .5) +
labs(title="Compound growth rate between 2017 and 2025 (%)", y = "CAGR (%)") +
theme_minimal() + theme(legend.position = "none") +
geom_text(aes(label=label_text), vjust=1.6, size=3)
p + coord_flip()
p<-ggplot(data=d, aes(x=age, y=cagr2025, fill = age)) +
geom_bar(stat="identity",  width = .5) +
labs(title="Compound growth rate between 2017 and 2025 (%)", y = "CAGR (%)") +
theme_minimal() + theme(legend.position = "none") +
geom_text(aes(label=label_text), hjust=1.6, size=3)
p + coord_flip()
p<-ggplot(data=d, aes(x=age, y=cagr2025, fill = age)) +
geom_bar(stat="identity",  width = .5) +
labs(title="Compound growth rate between 2017 and 2025 (%)", y = "CAGR (%)") +
theme_minimal() + theme(legend.position = "none") +
geom_text(aes(label=label_text), hjust=1, size=3, colour = "white")
p + coord_flip()
d<-pop[ district=="South East"]
d<-d[,age:cagr2025]
d$cagr2025<-d$cagr2025*100
label_text<-paste(round(d$cagr2025,2),"%", sep = "")
p<-ggplot(data=d, aes(x=age, y=cagr2025, fill = age)) +
geom_bar(stat="identity",  width = .5) +
labs(title="Compound growth rate between 2017 and 2025 (%)", y = "CAGR (%)") +
theme_minimal() + theme(legend.position = "none") +
geom_text(aes(label=label_text), hjust=1.2, size=3)
p + coord_flip()
plot1<-p + coord_flip()
plot2<-p + coord_flip()
grid.arrange(plot1, plot2, ncol=2)
require(grid.arrange)
library(gridExtra)
plot1<-p + coord_flip()
plot2<-p + coord_flip()
grid.arrange(plot1, plot2, ncol=2)
p<-ggplot(data=d, aes(x=age, y=cagr2025, fill = age)) +
geom_bar(stat="identity",  width = .5) +
labs(title="CAGR to 2025 (%)", y = "CAGR (%)") +
theme_minimal() + theme(legend.position = "none") +
geom_text(aes(label=label_text), hjust=1.2, size=3)
plot1<-p + coord_flip()
plot2<-p + coord_flip()
grid.arrange(plot1, plot2, ncol=2)
p<-ggplot(data=d, aes(x=age, y=cagr2035, fill = age)) +
geom_bar(stat="identity",  width = .5) +
labs(title="CAGR to 2035 (%)", y = "CAGR (%)") +
theme_minimal() + theme(legend.position = "none") +
geom_text(aes(label=label_text), hjust=1.2, size=3)
p
p + coord_flip()
label_text2<-paste(round(d$cagr2035,2),"%", sep = "")
p<-ggplot(data=d, aes(x=age, y=cagr2035, fill = age)) +
geom_bar(stat="identity",  width = .5) +
labs(title="CAGR to 2035 (%)", y = "CAGR (%)") +
theme_minimal() + theme(legend.position = "none") +
geom_text(aes(label=label_text2), hjust=1.2, size=3)
p + coord_flip()
plot2<-p + coord_flip()
grid.arrange(plot1, plot2, ncol=2)
d
d<-pop[ district=="South East"]
d<-d[,age:cagr2025]
d
d$cagr2025<-d$cagr2025*100
d$cagr2035<-d$cagr2035*100
d
label_text<-paste(round(d$cagr2025,2),"%", sep = "")
p<-ggplot(data=d, aes(x=age, y=cagr2025, fill = age)) +
geom_bar(stat="identity",  width = .5) +
labs(title="CAGR to 2025 (%)", y = "CAGR (%)") +
theme_minimal() + theme(legend.position = "none") +
geom_text(aes(label=label_text), hjust=1.2, size=3)
plot1<-p + coord_flip()
label_text2<-paste(round(d$cagr2035,2),"%", sep = "")
p<-ggplot(data=d, aes(x=age, y=cagr2035, fill = age)) +
geom_bar(stat="identity",  width = .5) +
labs(title="CAGR to 2035 (%)", y = "CAGR (%)") +
theme_minimal() + theme(legend.position = "none") +
geom_text(aes(label=label_text2), hjust=1.2, size=3)
plot2<-p + coord_flip()
grid.arrange(plot1, plot2, ncol=2)
